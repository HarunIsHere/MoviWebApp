<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>User Movies</title>
  </head>
  <body>
    <p><a href="{{ url_for('index') }}">← Back to users</a></p>

    <h1>Movies for {{ user.name }}</h1>

    <h2>Add movie</h2>
    <form method="post" action="{{ url_for('add_movie', user_id=user.id) }}">
      <input type="text" name="title" placeholder="Movie title" required />
      <button type="submit">Add</button>
    </form>

    <h2>Switch user</h2>
    <ul>
      {% for u in users %}
        <li>
          <a href="{{ url_for('user_movies', user_id=u.id) }}">{{ u.name }}</a>
        </li>
      {% endfor %}
    </ul>

    <h2>Movies</h2>
    {% if movies %}
      <ul>
        {% for movie in movies %}
          <li>
            {% if movie.poster_url %}
              <img src="{{ movie.poster_url }}" alt="poster" width="60" />
            {% endif %}

            <strong>{{ movie.name }}</strong>
            {% if movie.year %} ({{ movie.year }}){% endif %}
            {% if movie.director %} — {{ movie.director }}{% endif %}

            <!-- Codio-style UPDATE: POST, title only, no OMDb -->
            <form method="post"
                  action="{{ url_for('update_movie_codio', user_id=user.id, movie_id=movie.id) }}"
                  style="display:inline;">
              <input type="text" name="title" value="{{ movie.name }}" required />
              <button type="submit">Update</button>
            </form>

            <!-- Codio-style DELETE: POST -->
            <form method="post"
                  action="{{ url_for('delete_movie_codio', user_id=user.id, movie_id=movie.id) }}"
                  style="display:inline;">
              <button type="submit">Delete</button>
            </form>

            <!-- Optional: keep your separate update page too -->
            <!-- <a href="{{ url_for('update_movie_form', movie_id=movie.id) }}">Update page</a> -->
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p>No movies yet.</p>
    {% endif %}
  </body>
</html>